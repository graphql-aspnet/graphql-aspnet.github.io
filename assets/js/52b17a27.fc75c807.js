"use strict";(globalThis.webpackChunkmy_website=globalThis.webpackChunkmy_website||[]).push([[2980],{6237:(e,i,t)=>{t.r(i),t.d(i,{assets:()=>l,contentTitle:()=>o,default:()=>h,frontMatter:()=>c,metadata:()=>n,toc:()=>a});const n=JSON.parse('{"id":"reference/graph-directive","title":"Graph Directive","description":"\u2705 See the section on Directives for a detailed explination on how directive action methods work and how to declare them.","source":"@site/docs/reference/graph-directive.md","sourceDirName":"reference","slug":"/reference/graph-directive","permalink":"/docs/reference/graph-directive","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":5,"frontMatter":{"id":"graph-directive","title":"Graph Directive","sidebar_label":"GraphDirective","sidebar_position":5},"sidebar":"tutorialSidebar","previous":{"title":"GraphController","permalink":"/docs/reference/graph-controller"},"next":{"title":"HTTP Processor","permalink":"/docs/reference/http-processor"}}');var r=t(4848),s=t(8453);const c={id:"graph-directive",title:"Graph Directive",sidebar_label:"GraphDirective",sidebar_position:5},o=void 0,l={},a=[{value:"ModelState",id:"modelstate",level:2},{value:"Request",id:"request",level:2},{value:"Notable Items on the Request",id:"notable-items-on-the-request",level:3},{value:"User",id:"user",level:2},{value:"Schema",id:"schema",level:2}];function d(e){const i={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(i.p,{children:["\u2705 See the section on ",(0,r.jsx)(i.a,{href:"/docs/advanced/directives",children:"Directives"})," for a detailed explination on how directive action methods work and how to declare them."]}),"\n",(0,r.jsxs)(i.p,{children:["The ",(0,r.jsx)(i.code,{children:"GraphDirective"}),", from which all of your directives inherit, is a core object used throughout graphql. This page details some lesser known and lesser used object referenced made available to each directive."]}),"\n",(0,r.jsx)(i.h2,{id:"modelstate",children:"ModelState"}),"\n",(0,r.jsxs)(i.p,{children:["The completed model state dictionary with an entry for each validated parameter ",(0,r.jsx)(i.strong,{children:"of the directive"}),". The model state for the field being resolved is not accessible by the directive."]}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{className:"language-csharp",children:"public class AllowDirective : GraphDirective\n{\n    public IGraphActionResult BeforeResolution(FilterModel model)\n    {\n        if(!this.ModelState.IsValid)\n            return this.BadRequest(this.ModelState);\n\n        //...\n    }\n}\n"})}),"\n",(0,r.jsx)(i.h2,{id:"request",children:"Request"}),"\n",(0,r.jsx)(i.p,{children:"The individual directive request spawned from the field pipeline."}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{className:"language-csharp",children:"public class AllowDirective : GraphDirective\n{\n    public IGraphActionResult BeforeResolution(FilterModel model)\n    {\n        if(this.Request.SourceData is Human human)\n        {\n            // ...\n        }\n    }\n}\n"})}),"\n",(0,r.jsx)(i.h3,{id:"notable-items-on-the-request",children:"Notable Items on the Request"}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.code,{children:"Request.Directive"}),": Useful metadata related to the directive type being resolved."]}),"\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.code,{children:"Request.LifeCycle"}),": The enumeration value indicating which life cycle point is being executed."]}),"\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.code,{children:"Request.DirectiveLocation"}),": Indicates location in the query text this directive instance is currently being executed."]}),"\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.code,{children:"Request.DataSource"}),": The source data item being supplied to the field to be resolved."]}),"\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.code,{children:"Request.Items"}),": A collection of key/value pairs accessible to all fields and directives in this individual request pipeline."]}),"\n"]}),"\n",(0,r.jsx)(i.h2,{id:"user",children:"User"}),"\n",(0,r.jsxs)(i.p,{children:["The ",(0,r.jsx)(i.code,{children:"ClaimsPrincipal"})," created by ASP.NET when this request was authorized."]}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{className:"language-csharp",children:'public class MyCustomDirective : GraphDirective\n{\n    public IGraphActionResult BeforeResolution(FilterModel model)\n    {\n        if(this.User.Identity.Name == "DebbieEast")\n        {\n            // ...\n        }\n    }\n}\n'})}),"\n",(0,r.jsx)(i.h2,{id:"schema",children:"Schema"}),"\n",(0,r.jsxs)(i.p,{children:["The ",(0,r.jsx)(i.code,{children:"Schema"})," property contains a reference to the singleton instance of the schema the current controller is resolving a field for. This object is considered read-only and should not be modified."]}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{className:"language-csharp",children:"public class AllowDirective : GraphDirective\n{\n    public IGraphActionResult BeforeResolution(FilterModel model)\n    {\n        // highlight-next-line\n        IObjectGraphType droidType = this.Schema.KnownTypes.FindGraphType(typeof(Droid), TypeKind.OBJECT);\n        // ...\n    }\n}\n"})}),"\n",(0,r.jsx)(i.admonition,{type:"caution",children:(0,r.jsxs)(i.p,{children:["For type system directives, executed as part of schema construction, the schema object available may be incomplete or null. Avoid using and do not rely on the data in ",(0,r.jsx)(i.code,{children:"this.Schema"})," for type system directives."]})})]})}function h(e={}){const{wrapper:i}={...(0,s.R)(),...e.components};return i?(0,r.jsx)(i,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},8453:(e,i,t)=>{t.d(i,{R:()=>c,x:()=>o});var n=t(6540);const r={},s=n.createContext(r);function c(e){const i=n.useContext(s);return n.useMemo(function(){return"function"==typeof e?e(i):{...i,...e}},[i,e])}function o(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:c(e.components),n.createElement(s.Provider,{value:i},e.children)}}}]);